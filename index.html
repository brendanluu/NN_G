<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>New Nostalgia</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://assets.calendly.com/assets/external/widget.css" rel="stylesheet">
    <script src="https://assets.calendly.com/assets/external/widget.js" type="text/javascript" async></script>
</head>
<body>
    <div class="container">
        <header>
            <a href="index.html" class="header-link">
                <div class="new">NEW</div>
                <div class="nostalgia">NOSTALGIA<br><img src="assets/NN_logo_green.svg" alt="NN-G Logo" class="header-logo"></div>
            </a>
        </header>
        
        <div class="email-section">
            <div class="type-text">TYPE</div>
            <div class="email-text">YOUR EMAIL...</div>
            <div class="email-input-container">
                <input type="email" 
                       id="email-input-top" 
                       class="email-input" 
                       placeholder="" 
                       autocomplete="off" 
                       inputmode="email"
                       name="email-top-section"
                       style="background-color: #5DCB5D !important;">
            </div>
            <div class="enter">SUBSCRIBE</div>
            
            <div class="newsletter-form-container" style="display:none;">
                <form class="newsletter-form" action="https://app.loops.so/api/newsletter-form/clx3ufqjp00cth2d6tk6rmx8c" method="POST">
                    <input type="email" class="newsletter-form-input" name="email-hidden-top" autocomplete="off">
                    <button type="submit" class="newsletter-form-button">Subscribe</button>
                    <button type="button" class="newsletter-loading-button" style="display:none;">Loading...</button>
                </form>
                <div class="newsletter-success" style="display:none;">Thank you for subscribing!</div>
                <div class="newsletter-error" style="display:none;">
                    <div class="newsletter-error-message">Something went wrong.</div>
                    <button class="newsletter-back-button" style="display:none;">Back</button>
                </div>
            </div>
        </div>
        
        <div class="opt">OPT</div>
        <div class="in">IN</div>
        
        <div class="placeholder-section">
            <div class="upcoming-header">UPCOMING</div>
            <div class="upcoming-list">
                <div class="upcoming-event">
                    <div class="event-content">
                        <span class="event-date">SUN MAR 30</span><br>
                        <span class="event-title">NEW NOSTALGIA PRESENTS: <span class="holodome blue">HOLODOME</span></span><br>
                        <!-- Calendly link widget begin -->
                        <a href="" onclick="Calendly.initPopupWidget({url: 'https://calendly.com/jorponciano/holo-dome?primary_color=4285F4'});return false;" class="event-action blue">BOOK NOW</a>
                        <!-- Calendly link widget end --><br>
                        <span class="event-details"><span class="limited-text">(Limited 40)</span><br>
                        <span class="price-text">[$0.00]</span></span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="email-section">
            <div class="type-text">TYPE</div>
            <div class="email-text">YOUR EMAIL...</div>
            <div class="email-input-container">
                <input type="email" 
                       id="email-input-bottom" 
                       class="email-input" 
                       placeholder="" 
                       autocomplete="off" 
                       inputmode="email"
                       name="email-bottom-section"
                       style="background-color: #5DCB5D !important;">
            </div>
            <div class="enter">SUBSCRIBE</div>
            
            <div class="newsletter-form-container" style="display:none;">
                <form class="newsletter-form" action="https://app.loops.so/api/newsletter-form/clx3ufqjp00cth2d6tk6rmx8c" method="POST">
                    <input type="email" class="newsletter-form-input" name="email-hidden-bottom" autocomplete="off">
                    <button type="submit" class="newsletter-form-button">Subscribe</button>
                    <button type="button" class="newsletter-loading-button" style="display:none;">Loading...</button>
                </form>
                <div class="newsletter-success" style="display:none;">Thank you for subscribing!</div>
                <div class="newsletter-error" style="display:none;">
                    <div class="newsletter-error-message">Something went wrong.</div>
                    <button class="newsletter-back-button" style="display:none;">Back</button>
                </div>
            </div>
        </div>
        
        <div class="interactive-section">
            <h2>Interactive Features</h2>
            <!-- Interactive content will be here -->
        </div>
        
        <footer>
            <div class="footer-links">
                <a href="about.html">ABOUT</a>
                <a href="mailto:wwwnewnostalgia@gmail.com">CONTACT</a>
                <a href="privacy.html">PRIVACY POLICY</a>
            </div>
            <div class="copyright">
                <img src="assets/NN_logo_black.svg" alt="NN-G Logo" class="nn-logo">
                2025
            </div>
        </footer>
    </div>

    <script src="script.js"></script>
    <script>
    function submitHandler(event) {
      event.preventDefault();
      var container = event.target.parentNode;
      var form = container.querySelector(".newsletter-form");
      var formInput = container.querySelector(".newsletter-form-input");
      var success = container.querySelector(".newsletter-success");
      var errorContainer = container.querySelector(".newsletter-error");
      var errorMessage = container.querySelector(".newsletter-error-message");
      var backButton = container.querySelector(".newsletter-back-button");
      var submitButton = container.querySelector(".newsletter-form-button");
      var loadingButton = container.querySelector(".newsletter-loading-button");
      
    
      const rateLimit = () => {
        errorContainer.style.display = "flex";
        errorMessage.innerText = "Too many signups, please try again in a little while";
        submitButton.style.display = "none";
        formInput.style.display = "none";
        backButton.style.display = "block";
      }
    
      // Compare current time with time of previous sign up
      var time = new Date();
      var timestamp = time.valueOf();
      var previousTimestamp = localStorage.getItem("loops-form-timestamp");
    
      // If last sign up was less than a minute ago
      // display error
      if (previousTimestamp && Number(previousTimestamp) + 60000 > timestamp) {
        rateLimit();
        return;
      }
      localStorage.setItem("loops-form-timestamp", timestamp);
    
      submitButton.style.display = "none";
      loadingButton.style.display = "flex";
    
      var formBody = "userGroup=&mailingLists=&email=" 
        + encodeURIComponent(formInput.value)
        ;
    
      fetch(event.target.action, {
        method: "POST",
        body: formBody,
        headers: {
          "Content-Type": "application/x-www-form-urlencoded",
        },
      })
        .then((res) => [res.ok, res.json(), res])
        .then(([ok, dataPromise, res]) => {
          if (ok) {
            // If response successful, update the SUBSCRIBE button instead of showing success element
            var emailSection = container.closest('.email-section');
            var enterButton = emailSection.querySelector('.enter');
            if (enterButton) {
                enterButton.innerText = "THANK YOU";
                
                // After 5 seconds, change it back to SUBSCRIBE
                setTimeout(() => {
                    enterButton.innerText = "SUBSCRIBE";
                }, 5000);
            }
            
            // Don't display success, but reset the form
            success.style.display = "none";
            form.reset();
          } else {
            // If response unsuccessful
            // display error message or response status
            dataPromise.then(data => {
              errorContainer.style.display = "flex";
              errorMessage.innerText = data.message
                ? data.message
                : res.statusText;
            });
          }
        })
        .catch(error => {
          // check for cloudflare error
          if (error.message === "Failed to fetch") {
            // Show alert instead of rate limit UI
            alert("Too many signups, please try again in a little while");
            
            // Set button text to PLEASE WAIT for rate limit errors
            var emailSection = container.closest('.email-section');
            var enterButton = emailSection.querySelector('.enter');
            if (enterButton) {
                enterButton.innerText = "PLEASE WAIT";
                
                // After 60 seconds, change it back to SUBSCRIBE
                setTimeout(() => {
                    enterButton.innerText = "SUBSCRIBE";
                }, 60000);
            }
            loadingButton.style.display = "none";
            submitButton.style.display = "flex";
            return;
          }
          
          // If error caught, show alert instead of error container
          alert(error.message || "Oops! Something went wrong, please try again");
          
          // Reset to original state
          var emailSection = container.closest('.email-section');
          var enterButton = emailSection.querySelector('.enter');
          if (enterButton) {
              enterButton.innerText = "SUBSCRIBE";
          }
          errorContainer.style.display = "none";
          loadingButton.style.display = "none";
          submitButton.style.display = "flex";
          
          localStorage.setItem("loops-form-timestamp", '');
        })
        .finally(() => {
          // Don't hide the form input - keep it visible
          loadingButton.style.display = "none";
          submitButton.style.display = "flex";
        });
    }
    function resetFormHandler(event) {
      var container = event.target.parentNode;
      var formInput = container.querySelector(".newsletter-form-input");
      var success = container.querySelector(".newsletter-success");
      var errorContainer = container.querySelector(".newsletter-error");
      var errorMessage = container.querySelector(".newsletter-error-message");
      var backButton = container.querySelector(".newsletter-back-button");
      var submitButton = container.querySelector(".newsletter-form-button");
    
      success.style.display = "none";
      errorContainer.style.display = "none";
      errorMessage.innerText = "Oops! Something went wrong, please try again";
      backButton.style.display = "none";
      formInput.style.display = "flex";
      submitButton.style.display = "flex";
    }
    
    var formContainers = document.getElementsByClassName(
      "newsletter-form-container"
    );
    
    for (var i = 0; i < formContainers.length; i++) {
      var formContainer = formContainers[i]
      var handlersAdded = formContainer.classList.contains('newsletter-handlers-added')
      if (handlersAdded) continue;
      formContainer
        .querySelector(".newsletter-form")
        .addEventListener("submit", submitHandler);
      formContainer
        .querySelector(".newsletter-back-button")
        .addEventListener("click", resetFormHandler);
      formContainer.classList.add("newsletter-handlers-added");
    }

    // Replace the existing DOM ready handler with this simplified version
    document.addEventListener('DOMContentLoaded', function() {
        // Get direct references to both inputs and their containers
        const topInput = document.getElementById('email-input-top');
        const bottomInput = document.getElementById('email-input-bottom');
        
        // Find the direct parent container for each input
        const topContainer = topInput.parentElement;
        const bottomContainer = bottomInput.parentElement;
        
        // Clear any existing focus handlers to avoid conflicts
        topInput.removeEventListener('focus', null);
        topInput.removeEventListener('blur', null);
        bottomInput.removeEventListener('focus', null);
        bottomInput.removeEventListener('blur', null);
        
        // Set up focus handlers for top input
        topInput.addEventListener('focus', function() {
            console.log('Top input focused');
            topContainer.classList.add('input-focused');
        });
        
        topInput.addEventListener('blur', function() {
            console.log('Top input blurred');
            topContainer.classList.remove('input-focused');
        });
        
        // Set up focus handlers for bottom input
        bottomInput.addEventListener('focus', function() {
            console.log('Bottom input focused');
            bottomContainer.classList.add('input-focused');
        });
        
        bottomInput.addEventListener('blur', function() {
            console.log('Bottom input blurred');
            bottomContainer.classList.remove('input-focused');
        });
        
        // Force repaint of cursor elements to ensure they're visible on mobile
        [topContainer, bottomContainer].forEach(function(el) {
            // Toggle a class to force a repaint
            el.classList.add('force-visible');
            setTimeout(function() {
                el.classList.remove('force-visible');
            }, 10);
        });
    });

    // Add this after your existing scripts
    document.addEventListener('DOMContentLoaded', function() {
        const emailInputs = document.querySelectorAll('.email-input');
        const emailContainers = document.querySelectorAll('.email-input-container');
        
        // Initially show cursors
        emailContainers.forEach(container => {
            container.classList.add('show-cursor');
        });
        
        // When any input is clicked, hide all cursors permanently
        emailInputs.forEach(input => {
            input.addEventListener('click', function() {
                emailContainers.forEach(container => {
                    container.classList.remove('show-cursor');
                });
            });
        });
    });
    </script>
</body>
</html> 